<div class=" content">
  <div class=" row">
    <h2 class="text-muted">You can now recharge your phone, regardless of the operator, or a friend's phone thanks to the new Cannon recharge service.</h2>
    <hr>
    <div class=" col-lg-6">
      <div class="row">
        <div class=" card card-chart">
          <div class=" card-header">
            <h5 class=" card-category">Total of sended recharges</h5>
            <h3 class=" card-title">
              <i class=" tim-icons icon-bell-55 text-danger-states"> </i> {{totalSendedRecharges}} dh
            </h3>
          </div>
          <div class=" card-body">

          </div>
        </div>
      </div>

      <div class="row mt-5">
        <h2 class="text-muted col-sm-12">Recharge a phone</h2>
        <div class="col-sm-12">
          <ngb-alert [type]="'success'" *ngIf="success" [dismissible]="false">
            <button type="button" aria-hidden="true" class="close" data-dismiss="alert" aria-label="Close"
            >
              <i class="tim-icons icon-simple-remove"></i>
            </button>
            <span>
              <b> Success - </b>
you have recharge {{amount}} dh to the phone number {{receiverPhoneNumber}} with success
            </span>
          </ngb-alert>
          <ngb-alert [type]="'danger'"
                     *ngIf="failure"
                     [dismissible]="false">
            <button type="button"
                    aria-hidden="true"
                    class="close"
                    data-dismiss="alert"
                    aria-label="Close"
            >
              <i class="tim-icons icon-simple-remove"></i>
            </button>
            <span>
              <b> Error - </b> Something wrong, the recharge didn't succeed.
            </span>
          </ngb-alert>
        </div>
        <form
              name="form"
              #f="ngForm"
              (ngSubmit)="f.form.valid"
              class="form-group col-sm-12"
              novalidate
        >
          <label for="account">Select your account to make with this recharge</label>

          <select
            id="account"
            class="bg-white text-muted browser-default custom-select"
            (change)="selectChangeHandler($event)">
            <option selected class="text-black-50">Select your account</option>
            <option
              *ngFor="let acc of accounts"
              value="{{acc.accountNumber}}"
              class="text-muted">
              {{acc.accountNumber}}
            </option>
          </select>

          <label for="receiverPhoneNumber">Phone number to recharge</label>
          <input type="text"
                 name="receiverPhoneNumber"
                 id="receiverPhoneNumber"
                 class="bg-white form-control"
                 [(ngModel)]="receiverPhoneNumber"
                 #PhoneNumber = "ngModel"
                 [ngClass]="{'is-invalid' : f.submitted && PhoneNumber.invalid}"
                 required pattern="^06[0-9].*$"
                 required minlength="10"
                 required maxlength="10"

          >
          <div *ngIf="f.invalid && (PhoneNumber.dirty || PhoneNumber.touched)">
            <div *ngIf="PhoneNumber.errors.required" class="text-danger">required phone number</div>
            <div *ngIf="PhoneNumber.errors.pattern" class="text-danger">phone number need to contain only numbers starting with 06...</div>
            <div *ngIf="PhoneNumber.errors.maxlength" class="text-danger">phone number need to be exactly 10 digit</div>
            <div *ngIf="PhoneNumber.errors.minlength" class="text-danger">phone number need to be exactly 10 digit</div>

          </div>

          <label for="amount">Amount</label>
          <input type="text"
                 id="amount"
                 name = "amount"
                 class="bg-white form-control"
                 [(ngModel)]="amount"
                 #Amount = "ngModel"
                 [ngClass]="{'is-invalid' : f.submitted && Amount.invalid}"
                 required pattern="^[1-9].*$"
                 required min="10"
                 required max="1000"
          >
          <div *ngIf="f.invalid && (Amount.dirty || Amount.touched)">
            <div *ngIf="Amount.errors.required" class="text-danger">required amount</div>
            <div *ngIf="Amount.errors.pattern" class="text-danger">amount need to contain only integers numbers </div>
            <div *ngIf="Amount.errors.max" class="text-danger">The maximum amount to recharge is 1000 dh</div>
            <div *ngIf="Amount.errors.min" class="text-danger">The minimum amount to recharge is 10 dh</div>

          </div>
          <button class="btn btn-success mt-5 float-right"
                  (click)="recharge(accountNumber, receiverPhoneNumber ,amount)">
            Send
          </button>
        </form>
      </div>

    </div>

    <div class=" col-md-5">
      <div class=" card card-plain">
        <div class=" card-header">
          <h4 class=" card-title">All your recharges</h4>
          <p class=" category">You find here all your recharges</p>

        </div>
        <div class=" card-body">
          <div class=" table-responsive">
            <table class=" table tablesorter" id="">
              <thead class=" text-primary">
              <tr>
                <th>Account number</th>
                <th>To phone number</th>
                <th>Amount</th>
                <th class=" text-center">Date</th>

              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let rech of recharges ">
                <td>1234567892222222</td>
                <td>{{rech.receiverPhoneNumber}}</td>
                <td class=" text-center">{{rech.amount}} dh</td>
                <td class=" text-center">{{rech.date}}</td>
              </tr>

              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>


</div>
